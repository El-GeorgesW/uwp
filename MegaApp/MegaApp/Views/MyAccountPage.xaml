<views:BaseMyAccountPage
    x:Class="MegaApp.Views.MyAccountPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:extensions="using:MegaApp.Extensions"
    xmlns:triggers="using:WindowsStateTriggers"
    xmlns:viewModels="using:MegaApp.ViewModels"
    xmlns:views="using:MegaApp.Views"
    d:DataContext="{d:DesignInstance viewModels:MyAccountViewModel}"
    mc:Ignorable="d">

    <Page.Resources>
        <ControlTemplate x:Name="StorageOverquotaWarning">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Viewbox
                    Grid.Column="0"
                    Margin="0,4,12,0"
                    MaxWidth="16" MaxHeight="16"
                    VerticalAlignment="Top">
                    <PathIcon 
                        Data="{Binding WarningIconPathData, Mode=OneTime}"
                        Foreground="{StaticResource MegaRedColorBrush}" />
                </Viewbox>
                <TextBlock
                    Grid.Column="1"
                    Margin="0,0,0,28"
                    FontSize="14"
                    Opacity="0.7"
                    Text="{Binding StorageOverquotaWarningText, Mode=OneTime}"
                    TextWrapping="Wrap" />
            </Grid>
        </ControlTemplate>
        <ControlTemplate x:Name="TransferOverquotaWarning">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Viewbox
                    Grid.Column="0"
                    Margin="0,4,12,0"
                    MaxWidth="16" MaxHeight="16"
                    VerticalAlignment="Top">
                    <PathIcon 
                        Data="{Binding WarningIconPathData, Mode=OneTime}"
                        Foreground="{StaticResource MegaRedColorBrush}" />
                </Viewbox>
                <TextBlock
                    Grid.Column="1"
                    Margin="0,0,0,28"
                    FontSize="14"
                    Opacity="0.7"
                    Text="{Binding TransferOverquotaWarningText, Mode=OneTime}"
                    TextWrapping="Wrap" />
            </Grid>
        </ControlTemplate>
        <ControlTemplate x:Name="TransferQuotaProgressBar">
            <ProgressBar
                Background="{ThemeResource MegaProgressBarBackgroundBrush}"
                IsIndeterminate="False"
                Margin="0,0,0,20"
                Maximum="{Binding AccountDetails.TransferQuota, Mode=OneWay}"
                Minimum="0"
                Value="{Binding AccountDetails.UsedTransferQuota, Mode=OneWay}">
                <ProgressBar.Foreground>
                    <SolidColorBrush Color="{Binding AccountDetails.TransferQuotaProgressBarColor}" />
                </ProgressBar.Foreground>
            </ProgressBar>
        </ControlTemplate>
    </Page.Resources>
    
    <Grid x:Name="MainGrid" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition x:Name="TopRow" Height="{StaticResource PageHeaderRowHeight}"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Background="{StaticResource MegaAppBarBackgroundBrush}"/>

        <CommandBar
            x:Name="TopCommandBar"
            Grid.Row="0"
            Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
            extensions:CommandBarExtensions.HideMoreButton="True"
            Style="{StaticResource MegaCommandBarStyle}">
            <AppBarButton 
                Style="{StaticResource MegaAppBarButtonStyle}"
                Label="{Binding LogOutText, Mode=OneTime}" 
                ToolTipService.ToolTip="{Binding LogOutText, Mode=OneTime}"
                Command="{Binding LogOutCommand}"
                Click="OnButtonClick">
                <Viewbox MaxWidth="14" MaxHeight="14">
                    <FontIcon Glyph="&#xE7E8;"/>
                </Viewbox>
            </AppBarButton>
        </CommandBar>

        <Grid Grid.Row="1" Margin="12,0">
            <Pivot
                x:Name="MyAccountPivot"
                HeaderTemplate="{StaticResource MegaPivoHeaderTemplate}"
                SelectionChanged="OnPivotSelectionChanged">
                <PivotItem
                    x:Name="GeneralPivot"
                    DataContext="{Binding GeneralViewModel}"
                    Header="{Binding Title, Mode=OneTime}"
                    CacheMode="{x:Null}">
                    <ScrollViewer
                        Margin="0,0,-12,0"
                        VerticalScrollBarVisibility="Auto">
                        <StackPanel 
                            x:Name="GeneralStackPanel" 
                            HorizontalAlignment="Left">
                            <TextBlock
                                Margin="0,56,0,20"
                                Style="{ThemeResource MegaHeaderFontStyle}"
                                Text="{Binding AccountOverviewTitle, Mode=OneTime}" />
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock
                                            x:Name="PlanTypeLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding PlanTypeText, Mode=OneTime}" />
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox
                                                Margin="0,4,12,0"
                                                MaxWidth="16" MaxHeight="16"
                                                VerticalAlignment="Top"
                                                Visibility="{Binding AccountDetails.AccountTypePathData, Converter={StaticResource StringVisibilityConverter}}">
                                                <PathIcon
                                                    Data="{Binding AccountDetails.AccountTypePathData, Mode=OneWay}">
                                                    <PathIcon.Foreground>
                                                        <SolidColorBrush Color="{Binding AccountDetails.AccountTypePathDataColor, Mode=OneWay}"/>
                                                    </PathIcon.Foreground>
                                                </PathIcon>
                                            </Viewbox>
                                            <TextBlock 
                                                x:Name="PlanTypeText" 
                                                Style="{ThemeResource MegaBodyFontStyle}"
                                                Text="{Binding AccountDetails.AccountTypeText, Mode=OneWay}" />
                                        </StackPanel>
                                    </StackPanel>
                                    <StackPanel 
                                        Grid.Column="1"
                                        Visibility="{Binding AccountDetails.ProExpirationDate, Converter={StaticResource StringVisibilityConverter}}">
                                        <TextBlock
                                            x:Name="SubscriptionEndsLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding SubscriptionEndsText, Mode=OneTime}" />
                                        <TextBlock
                                            x:Name="SubscriptionEndsText"
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.ProExpirationDate, Mode=OneWay}" />
                                    </StackPanel>
                                    <StackPanel 
                                        Grid.Column="1"
                                        Visibility="{Binding AccountDetails.SubscriptionRenewDate, Converter={StaticResource StringVisibilityConverter}}">
                                        <TextBlock
                                            x:Name="SubscriptionRenewsLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding SubscriptionRenewsText, Mode=OneTime}" />
                                        <TextBlock
                                            x:Name="SubscriptionRenewsText"
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.SubscriptionRenewDate, Mode=OneWay}" />
                                    </StackPanel>
                                </Grid>
                                <StackPanel 
                                    Grid.Row="1"
                                    Margin="0,36,0,0"
                                    Orientation="Horizontal">
                                    <Button
                                        Width="136"
                                        Margin="0,0,4,0"
                                        Command="{Binding UpgradeCommand}"
                                        Content="{Binding UpgradeText, Mode=OneTime}"/>
                                    <!--<Button
                                        Width="136"
                                        Margin="4,0,0,0"
                                        Command="{Binding CancelSubscriptionCommand}"
                                        Content="{Binding CancelSubscriptionText, Mode=OneTime}" />-->
                                </StackPanel>
                            </Grid>

                            <StackPanel Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock
                                    Margin="0,64,0,20"
                                    Style="{ThemeResource MegaHeaderFontStyle}"
                                    Text="{Binding PaymentInformationTitle, Mode=OneTime}" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <StackPanel Grid.Column="0" Grid.Row="0">
                                        <TextBlock
                                            x:Name="PaymentMethodLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding PaymentMethodText, Mode=OneTime}" />
                                        <TextBlock
                                            x:Name="PaymentMethodText"
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.PaymentMethod, Mode=OneWay}" />
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Grid.Row="0">
                                        <TextBlock
                                            x:Name="SubscriptionTypeLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding SubscriptionTypeText, Mode=OneTime}" />
                                        <TextBlock
                                            x:Name="SubscriptionTypeText"
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.SubscriptionType, Mode=OneWay}" />
                                    </StackPanel>
                                </Grid>
                            </StackPanel>

                            <TextBlock
                                Margin="0,64,0,20"
                                Style="{ThemeResource MegaHeaderFontStyle}"
                                Text="{Binding OverallUsageTitle, Mode=OneTime}" />
                            <StackPanel>
                                <TextBlock
                                    Margin="0,0,0,28"
                                    FontSize="14"
                                    Opacity="0.7"
                                    Text="{Binding OverallUsageText, Mode=OneTime}"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding AccountDetails.IsInOverquota, Converter={StaticResource InverseBoolToVisibilityConverter}}" />
                                <ContentControl 
                                    Template="{StaticResource StorageOverquotaWarning}"
                                    Visibility="{Binding AccountDetails.IsInStorageOverquota, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                <ContentControl 
                                    Template="{StaticResource TransferOverquotaWarning}"
                                    Visibility="{Binding AccountDetails.IsInTransferOverquota, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                <ProgressBar
                                    Background="{ThemeResource MegaProgressBarBackgroundBrush}"
                                    IsIndeterminate="False"
                                    Maximum="{Binding AccountDetails.TotalSpace, Mode=OneWay}"
                                    Minimum="0"
                                    Value="{Binding AccountDetails.UsedSpace, Mode=OneWay}">
                                    <ProgressBar.Foreground>
                                        <SolidColorBrush Color="{Binding AccountDetails.StorageProgressBarColor}" />
                                    </ProgressBar.Foreground>
                                </ProgressBar>
                                <Grid Margin="0,20,0,32">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock
                                            x:Name="TotalStorageLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding TotalStorageText, Mode=OneTime}" />
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox
                                                Margin="0,0,12,0"
                                                MaxWidth="14" MaxHeight="14"
                                                Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                <PathIcon Data="{Binding NoteIconPathData, Mode=OneTime}" />
                                            </Viewbox>
                                            <TextBlock
                                                x:Name="TotalStorageText"
                                                Style="{ThemeResource MegaBodyFontStyle}"
                                                Text="{Binding AccountDetails.TotalSpaceText, Mode=OneWay}" />
                                        </StackPanel>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock
                                            x:Name="UsedStorageLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding UsedStorageText, Mode=OneTime}" />
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox
                                                Margin="0,0,12,0"
                                                MaxWidth="16" MaxHeight="16"
                                                Visibility="{Binding AccountDetails.IsInStorageOverquota, Converter={StaticResource BoolToVisibilityConverter}}">
                                                <PathIcon
                                                    Data="{Binding WarningIconPathData, Mode=OneTime}"
                                                    Foreground="{StaticResource MegaRedColorBrush}" />
                                            </Viewbox>
                                            <TextBlock
                                                x:Name="UsedStorageText"
                                                Style="{ThemeResource MegaBodyFontStyle}"
                                                Text="{Binding AccountDetails.UsedSpaceText, Mode=OneWay}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                                <ContentControl
                                    Template="{StaticResource TransferQuotaProgressBar}"
                                    Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource BoolToVisibilityConverter}}" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock
                                            x:Name="TotalTransferQuotaLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding TotalTransferQuotaText, Mode=OneTime}" />
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox
                                                Margin="0,0,12,0"
                                                MaxWidth="14" MaxHeight="14"
                                                Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                <PathIcon Data="{Binding NoteIconPathData, Mode=OneTime}" />
                                            </Viewbox>
                                            <TextBlock
                                                x:Name="TotalTransferQuotaText"
                                                Style="{ThemeResource MegaBodyFontStyle}"
                                                Text="{Binding AccountDetails.TransferQuotaText, Mode=OneWay}" />
                                        </StackPanel>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock
                                            x:Name="UsedTransferQuotaLabelText"
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding UsedTransferQuotaText, Mode=OneTime}" />
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox
                                                Margin="0,0,12,0"
                                                MaxWidth="16" MaxHeight="16"
                                                Visibility="{Binding AccountDetails.IsInTransferOverquota, Converter={StaticResource BoolToVisibilityConverter}}">
                                                <PathIcon
                                                    Data="{Binding WarningIconPathData, Mode=OneTime}"
                                                    Foreground="{StaticResource MegaRedColorBrush}" />
                                            </Viewbox>
                                            <TextBlock
                                                x:Name="UsedTransferQuotaText"
                                                Style="{ThemeResource MegaBodyFontStyle}"
                                                Text="{Binding AccountDetails.UsedTransferQuotaText, Mode=OneWay}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                                <StackPanel 
                                    Margin="0,36,0,0"
                                    Orientation="Horizontal">
                                    <Button
                                        Width="136"
                                        Margin="0,0,4,0"
                                        Command="{Binding UpgradeCommand}"
                                        Content="{Binding UpgradeText, Mode=OneTime}"
                                        Visibility="{Binding AccountDetails.IsInOverquota, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <Button
                                        Width="136"
                                        Margin="4,0,0,0"
                                        Command="{Binding RubbishBinCommand}"
                                        Content="{Binding RubbishBinText, Mode=OneTime}"
                                        Visibility="{Binding AccountDetails.IsInStorageOverquota, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </PivotItem>
                <PivotItem
                    x:Name="ProfilePivot"
                    Header="{Binding ProfileTitle, Mode=OneTime}"
                    CacheMode="{x:Null}">
                </PivotItem>
                <PivotItem
                    x:Name="StorageAndTransferPivot"
                    DataContext="{Binding StorageAndTransferViewModel}"
                    Header="{Binding Title, Mode=OneTime}"
                    CacheMode="{x:Null}">
                    <ScrollViewer
                        Margin="0,0,-12,0"
                        VerticalScrollBarVisibility="Auto">
                        <StackPanel 
                            x:Name="StorageAndTransferStackPanel"
                            HorizontalAlignment="Left">
                            <TextBlock
                                Margin="0,56,0,20"
                                Style="{ThemeResource MegaHeaderFontStyle}"
                                Text="{Binding UsedStorageTitle, Mode=OneTime}" />
                            <Grid Margin="0,0,0,32">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ContentControl 
                                    Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                    Template="{StaticResource StorageOverquotaWarning}"
                                    Visibility="{Binding AccountDetails.IsInStorageOverquota, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                <StackPanel Grid.Column="0" Grid.Row="1" Margin="0,0,0,32">
                                    <TextBlock
                                        Style="{ThemeResource MegaTitleFontStyle}"
                                        Text="{Binding TotalStorageText, Mode=OneTime}" />
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox
                                            Margin="0,0,12,0"
                                            MaxWidth="14" MaxHeight="14"
                                            Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                            <PathIcon Data="{Binding NoteIconPathData, Mode=OneTime}" />
                                        </Viewbox>
                                        <TextBlock
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.TotalSpaceText, Mode=OneWay}" />
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Grid.Row="1">
                                    <TextBlock
                                        Style="{ThemeResource MegaTitleFontStyle}"
                                        Text="{Binding UsedStorageText, Mode=OneTime}" />
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox
                                            Margin="0,0,12,0"
                                            MaxWidth="16" MaxHeight="16"
                                            Visibility="{Binding AccountDetails.IsInStorageOverquota, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <PathIcon
                                                Data="{Binding WarningIconPathData, Mode=OneTime}"
                                                Foreground="{StaticResource MegaRedColorBrush}" />
                                        </Viewbox>
                                        <TextBlock
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.UsedSpaceText, Mode=OneWay}" />
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Grid.Column="0" Grid.Row="2">
                                    <TextBlock
                                        Style="{ThemeResource MegaTitleFontStyle}"
                                        Text="{Binding AvailableStorageText, Mode=OneTime}" />
                                    <TextBlock
                                        Style="{ThemeResource MegaBodyFontStyle}"
                                        Text="{Binding AccountDetails.FreeSpaceText, Mode=OneWay}" />
                                </StackPanel>
                            </Grid>
                            <Grid>
                                <ProgressBar
                                    Background="{ThemeResource MegaProgressBarBackgroundBrush}"
                                    IsIndeterminate="False"
                                    Maximum="{Binding AccountDetails.TotalSpace, Mode=OneWay}"
                                    Minimum="0"
                                    Value="{Binding RubbishBinUsedSpaceProgressVarValue, Mode=OneWay}">
                                    <ProgressBar.Foreground>
                                        <SolidColorBrush Color="{Binding RubbishBinColor, Mode=OneWay}" />
                                    </ProgressBar.Foreground>
                                </ProgressBar>
                                <ProgressBar
                                    Background="Transparent"
                                    IsIndeterminate="False"
                                    Maximum="{Binding AccountDetails.TotalSpace, Mode=OneWay}"
                                    Minimum="0"
                                    Value="{Binding IncomingSharesUsedSpaceProgressVarValue, Mode=OneWay}">
                                    <ProgressBar.Foreground>
                                        <SolidColorBrush Color="{Binding IncomingSharesColor, Mode=OneWay}" />
                                    </ProgressBar.Foreground>
                                </ProgressBar>
                                <ProgressBar
                                    Background="Transparent"
                                    IsIndeterminate="False"
                                    Maximum="{Binding AccountDetails.TotalSpace, Mode=OneWay}"
                                    Minimum="0"
                                    Value="{Binding CloudDriveUsedSpaceProgressVarValue, Mode=OneWay}">
                                    <ProgressBar.Foreground>
                                        <SolidColorBrush Color="{StaticResource MegaRedColor}" />
                                    </ProgressBar.Foreground>
                                </ProgressBar>
                            </Grid>
                            <Grid Margin="0,24,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0" Margin="0,0,0,32">
                                    <StackPanel Orientation="Horizontal">
                                        <Rectangle 
                                            Margin="0,4,8,0"
                                            Width="4" Height="12"
                                            VerticalAlignment="Top">
                                            <Rectangle.Fill>
                                                <SolidColorBrush Color="{StaticResource MegaRedColor}"/>
                                            </Rectangle.Fill>
                                        </Rectangle>
                                        <TextBlock
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding CloudDriveText, Mode=OneTime}" />
                                    </StackPanel>
                                    <TextBlock
                                        Style="{ThemeResource MegaBodyFontStyle}"
                                        Text="{Binding AccountDetails.CloudDriveUsedSpaceText, Mode=OneWay}" />
                                </StackPanel>
                                <StackPanel Grid.Column="1" Grid.Row="0">
                                    <StackPanel Orientation="Horizontal">
                                        <Rectangle 
                                            Margin="0,4,8,0"
                                            Width="4" Height="12"
                                            VerticalAlignment="Top">
                                            <Rectangle.Fill>
                                                <SolidColorBrush Color="{Binding IncomingSharesColor, Mode=OneWay}"/>
                                            </Rectangle.Fill>
                                        </Rectangle>
                                        <TextBlock
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding IncomingSharesText, Mode=OneTime}" />
                                    </StackPanel>
                                    <TextBlock
                                        Style="{ThemeResource MegaBodyFontStyle}"
                                        Text="{Binding AccountDetails.IncomingSharesUsedSpaceText, Mode=OneWay}" />
                                </StackPanel>
                                <StackPanel Grid.Column="0" Grid.Row="1">
                                    <StackPanel Orientation="Horizontal">
                                        <Rectangle 
                                            Margin="0,4,8,0"
                                            Width="4" Height="12"
                                            VerticalAlignment="Top">
                                            <Rectangle.Fill>
                                                <SolidColorBrush Color="{Binding RubbishBinColor, Mode=OneWay}"/>
                                            </Rectangle.Fill>
                                        </Rectangle>
                                        <TextBlock
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding RubbishBinText, Mode=OneTime}" />
                                    </StackPanel>
                                    <TextBlock
                                        Style="{ThemeResource MegaBodyFontStyle}"
                                        Text="{Binding AccountDetails.RubbishBinUsedSpaceText, Mode=OneWay}" />
                                </StackPanel>
                            </Grid>
                            <StackPanel
                                Margin="0,36,0,0"
                                Orientation="Horizontal"
                                Visibility="{Binding AccountDetails.IsInStorageOverquota, Converter={StaticResource BoolToVisibilityConverter}}">
                                <Button
                                    Width="136"
                                    Margin="0,0,4,0"
                                    Command="{Binding UpgradeCommand}"
                                    Content="{Binding UpgradeText, Mode=OneTime}"/>
                                <Button
                                    Width="136"
                                    Margin="4,0,0,0"
                                    Command="{Binding RubbishBinCommand}"
                                    Content="{Binding RubbishBinText, Mode=OneTime}"/>
                            </StackPanel>
                            <TextBlock
                                Margin="0,64,0,20"
                                Style="{ThemeResource MegaHeaderFontStyle}"
                                Text="{Binding TransferQuotaTitle, Mode=OneTime}" />
                            <ContentControl 
                                Template="{StaticResource TransferOverquotaWarning}"
                                Visibility="{Binding AccountDetails.IsInTransferOverquota, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <ContentControl
                                Margin="0,8,0,0"
                                Template="{StaticResource TransferQuotaProgressBar}"
                                Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource BoolToVisibilityConverter}}" />
                            <Grid Margin="0,0,0,36">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Column="0" Grid.Row="0">
                                    <TextBlock
                                        Style="{ThemeResource MegaTitleFontStyle}"
                                        Text="{Binding TotalTransferQuotaText, Mode=OneTime}" />
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox
                                            Margin="0,0,12,0"
                                            MaxWidth="14" MaxHeight="14"
                                            Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                            <PathIcon Data="{Binding NoteIconPathData, Mode=OneTime}" />
                                        </Viewbox>
                                        <TextBlock
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.TransferQuotaText, Mode=OneWay}" />
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Grid.Row="0">
                                    <TextBlock
                                        Style="{ThemeResource MegaTitleFontStyle}"
                                        Text="{Binding UsedTransferQuotaText, Mode=OneTime}" />
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox
                                            Margin="0,0,12,0"
                                            MaxWidth="16" MaxHeight="16"
                                            Visibility="{Binding AccountDetails.IsInTransferOverquota, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <PathIcon
                                                Data="{Binding WarningIconPathData, Mode=OneTime}"
                                                Foreground="{StaticResource MegaRedColorBrush}" />
                                        </Viewbox>
                                        <TextBlock
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.UsedTransferQuotaText, Mode=OneWay}" />
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel 
                                    Margin="0,32,0,0"
                                    Grid.Column="0" Grid.Row="1"
                                    Visibility="{Binding AccountDetails.IsProAccount, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <TextBlock
                                        Style="{ThemeResource MegaTitleFontStyle}"
                                        Text="{Binding AvailableTransferQuotaText, Mode=OneTime}" />
                                    <TextBlock
                                        Style="{ThemeResource MegaBodyFontStyle}"
                                        Text="{Binding AccountDetails.AvailableTransferQuotaText, Mode=OneWay}" />
                                </StackPanel>
                                <StackPanel 
                                    Margin="0,32,0,0"
                                    Grid.Column="1" Grid.Row="1"
                                    Visibility="{Binding AccountDetails.IsInTransferOverquota, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <TextBlock
                                        Style="{ThemeResource MegaTitleFontStyle}"
                                        Text="{Binding PleaseWaitText, Mode=OneTime}" />
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox
                                            Margin="0,0,12,0"
                                            MaxWidth="16" MaxHeight="16">
                                            <PathIcon
                                                Data="{Binding WarningIconPathData, Mode=OneTime}"
                                                Foreground="{StaticResource MegaRedColorBrush}" />
                                        </Viewbox>
                                        <TextBlock
                                            Style="{ThemeResource MegaBodyFontStyle}"
                                            Text="{Binding AccountDetails.TransferOverquotaDelayText, Mode=OneWay}" />
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                            <Button
                                Width="136"
                                Command="{Binding UpgradeCommand}"
                                Content="{Binding UpgradeText, Mode=OneTime}"
                                Visibility="{Binding AccountDetails.IsInTransferOverquota, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        </StackPanel>
                    </ScrollViewer>
                </PivotItem>
                <PivotItem
                    x:Name="UpgradePivot"
                    DataContext="{Binding UpgradeViewModel}"
                    Header="{Binding Title, Mode=OneTime}"
                    CacheMode="{x:Null}">
                    <ScrollViewer
                        Margin="0,0,-12,0"
                        VerticalScrollBarVisibility="Auto">
                        <StackPanel 
                            x:Name="UpgradeStackPanel"
                            HorizontalAlignment="Left">
                            <StackPanel
                                Height="17"
                                Margin="0,22,0,16"
                                Orientation="Horizontal">
                                <Button
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Tapped="OnUpgradeBackButtonTapped"
                                    Visibility="{Binding BackButtonVisibility, Mode=OneWay}">
                                    <Viewbox MaxWidth="16" MaxHeight="12">
                                        <PathIcon
                                            Data="{Binding BackIconPathData, Mode=OneTime}"
                                            Foreground="{StaticResource MegaRedColorBrush}" />
                                    </Viewbox>
                                </Button>
                                <TextBlock
                                    Foreground="{StaticResource MegaRedColorBrush}"
                                    Style="{ThemeResource CaptionTextBlockStyle}"
                                    Text="{Binding StepBreadcrumText, Mode=OneWay}"
                                    VerticalAlignment="Center" />
                            </StackPanel>
                            <TextBlock
                                Margin="0,16,0,0"
                                Style="{ThemeResource MegaHeaderFontStyle}"
                                Text="{Binding StepTitleText, Mode=OneWay}" />
                            <GridView
                                x:Name="PlansGrid"
                                Margin="0,32,0,64"
                                Tapped="OnProPlanSelected"
                                ItemTemplate="{StaticResource ProductItemTemplateDesktop}"
                                ItemsSource="{Binding UpgradeAccount.Plans}"
                                ScrollViewer.HorizontalScrollMode="Enabled"
                                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                ScrollViewer.IsHorizontalRailEnabled="True"
                                ScrollViewer.VerticalScrollMode="Disabled"
                                Visibility="{Binding CurrentStep, ConverterParameter=1, Converter={StaticResource IntValueToVisibilityConverter}}">
                                <GridView.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Top"/>
                                    </ItemsPanelTemplate>
                                </GridView.ItemsPanel>
                            </GridView>
                            <Grid 
                                Margin="0,32,0,64"
                                Visibility="{Binding CurrentStep, ConverterParameter=2, Converter={StaticResource IntValueToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ContentControl
                                    Grid.Column="0"
                                    Margin="0,0,40,0"
                                    Content="{Binding SelectedPlan, Mode=OneWay}"
                                    ContentTemplate="{StaticResource ProductItemTemplateDesktop}"/>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Grid.Row="0">
                                        <TextBlock
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding MembershipDurationText, Mode=OneTime}" />
                                        <RadioButton 
                                            x:Name="MonthlyRadioButton"
                                            GroupName="MembershipDuration"
                                            Tag="Monthly"
                                            Checked="OnMembershipRadioButtonChecked">
                                            <RadioButton.Content>
                                                <TextBlock
                                                    Style="{ThemeResource MegaBodyFontStyle}"
                                                    Text="{Binding MonthlyProductPrice, Mode=OneWay}"/>
                                            </RadioButton.Content>
                                        </RadioButton>
                                        <RadioButton 
                                            x:Name="AnnualRadioButton"
                                            Margin="0,40,0,0"
                                            GroupName="MembershipDuration"
                                            Checked="OnMembershipRadioButtonChecked"
                                            Tag="Annual">
                                            <RadioButton.Content>
                                                <StackPanel>
                                                    <TextBlock 
                                                        Style="{ThemeResource MegaBodyFontStyle}"
                                                        Text="{Binding AnnualProductPrice, Mode=OneWay}"/>
                                                    <TextBlock 
                                                        Style="{ThemeResource MegaBodyFontStyle}"
                                                        Foreground="{StaticResource MegaRedColorBrush}"
                                                        Text="{Binding SavedMoney, Mode=OneWay}"/>
                                                </StackPanel>
                                            </RadioButton.Content>
                                        </RadioButton>
                                    </StackPanel>
                                    <Button 
                                        Grid.Row="1"
                                        Width="136"
                                        Command="{Binding MembershipDurationSelectedCommand}"
                                        Content="{Binding NextText, Mode=OneTime}"/>
                                </Grid>
                            </Grid>
                            <Grid 
                                Margin="0,32,0,64"
                                Visibility="{Binding CurrentStep, ConverterParameter=3, Converter={StaticResource IntValueToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ContentControl
                                    Grid.Column="0"
                                    Margin="0,0,40,0"
                                    Content="{Binding SelectedProduct, Mode=OneWay}"
                                    ContentTemplate="{StaticResource ProductItemTemplateDesktop}"/>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Grid.Row="0">
                                        <TextBlock
                                            Style="{ThemeResource MegaTitleFontStyle}"
                                            Text="{Binding PaymentMethodText, Mode=OneTime}" />
                                        <RadioButton 
                                            x:Name="InAppPurchaseRadioButton"
                                            GroupName="PaymentMethod"
                                            Tag="InAppPurchase"
                                            Checked="OnPaymentMethodRadioButtonChecked"
                                            Visibility="{Binding IsInAppPaymentMethodAvailable, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <RadioButton.Content>
                                                <TextBlock
                                                    Style="{ThemeResource MegaBodyFontStyle}"
                                                    Text="{Binding InAppPurchaseText, Mode=OneTime}"/>
                                            </RadioButton.Content>
                                        </RadioButton>
                                        <RadioButton 
                                            x:Name="FortumoRadioButton"
                                            Margin="0,0,0,36"
                                            GroupName="PaymentMethod"
                                            Tag="Fortumo"
                                            Checked="OnPaymentMethodRadioButtonChecked"
                                            Visibility="{Binding IsFortumoPaymentMethodAvailable, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <RadioButton.Content>
                                                <TextBlock
                                                    Style="{ThemeResource MegaBodyFontStyle}"
                                                    Text="{Binding FortumoText, Mode=OneTime}"/>
                                            </RadioButton.Content>
                                        </RadioButton>
                                        <RadioButton 
                                            x:Name="CentiliRadioButton"
                                            Margin="0,0,0,36"
                                            GroupName="PaymentMethod"
                                            Tag="Centili"
                                            Checked="OnPaymentMethodRadioButtonChecked"
                                            Visibility="{Binding IsCentiliPaymentMethodAvailable, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <RadioButton.Content>
                                                <TextBlock
                                                    Style="{ThemeResource MegaBodyFontStyle}"
                                                    Text="{Binding CentiliText, Mode=OneTime}"/>
                                            </RadioButton.Content>
                                        </RadioButton>
                                    </StackPanel>
                                    <Button 
                                        Grid.Row="1"
                                        Width="136"
                                        Command="{Binding PaymentMethodSelectedCommand}"
                                        Content="{Binding PurchaseText, Mode=OneTime}"
                                        IsEnabled="{Binding IsPurchaseButtonEnabled, Mode=OneWay}"/>
                                </Grid>
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </PivotItem>
            </Pivot>
        </Grid>
        
        <CommandBar
            x:Name="BottomCommandBar"
            Grid.Row="2"
            Style="{StaticResource MegaCommandBarStyle}">
            <AppBarButton 
                Click="OnButtonClick"
                Command="{Binding LogOutCommand}"
                Label="{Binding LogOutText, Mode=OneTime}" 
                ToolTipService.ToolTip="{Binding LogOutText, Mode=OneTime}"
                Style="{StaticResource MegaAppBarButtonStyle}">
                <Viewbox MaxWidth="14" MaxHeight="14">
                    <FontIcon Glyph="&#xE7E8;"/>
                </Viewbox>
            </AppBarButton>
        </CommandBar>
        
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState x:Name="Mobile">
                    <VisualState.StateTriggers>
                        <triggers:DeviceFamilyStateTrigger DeviceFamily="Mobile"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="TopRow.Height" Value="{StaticResource PageHeaderRowHeight}"/>
                        <Setter Target="TopCommandBar.Visibility" Value="Collapsed"/>
                        <Setter Target="BottomCommandBar.Visibility" Value="Visible"/>
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="Desktop">
                    <VisualState.StateTriggers>
                        <triggers:DeviceFamilyStateTrigger DeviceFamily="Desktop"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="TopRow.Height" Value="Auto"/>
                        <Setter Target="TopCommandBar.Visibility" Value="Visible"/>
                        <Setter Target="BottomCommandBar.Visibility" Value="Collapsed"/>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</views:BaseMyAccountPage>

<views:BaseTransferManagerPage
    x:Class="MegaApp.Views.TransferManagerPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="using:MegaApp.Views"
    xmlns:viewModels="using:MegaApp.ViewModels"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance viewModels:TransferManagerViewModel}">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
            <Grid.RowDefinitions>
                <RowDefinition Height="48"/>
                <RowDefinition/>
            </Grid.RowDefinitions>

            <Grid
                Grid.Row="0"
                Background="{StaticResource MegaAppBarBackgroundBrush}">
            </Grid>
            <Grid Grid.Row="1">
                <Pivot 
                x:Name="TransfersPivot" 
                HeaderTemplate="{StaticResource MegaPivoHeaderTemplate}"                 
                SelectionChanged="OnPivotSelectionChanged">
                    <PivotItem 
                        x:Name="UploadsPivot"                     
                        Header="{Binding UploadsText}"
                        Margin="0,-10,0,0">
                        <ListView
                            x:Name="LstUploads"
                            Background="{StaticResource MegaAppBackgroundBrush}"
                            ItemsSource="{Binding MegaTransfers.Uploads}"
                            ItemTemplate="{StaticResource MegaTransferItemContent}"
                            RightTapped="OnRightTapped"
                            Holding="OnHolding">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <FlyoutBase.AttachedFlyout>
                                <MenuFlyout x:Name="UploadsMenuFlyout">
                                    <MenuFlyout.Items>
                                        <MenuFlyoutItem
                                            Text="{Binding CancelText}"
                                            Command="{Binding CancelTransferCommand}"/>
                                    </MenuFlyout.Items>
                                </MenuFlyout>
                            </FlyoutBase.AttachedFlyout>
                        </ListView>
                    </PivotItem>
                    <PivotItem 
                        x:Name="DownloadsPivot"                     
                        Header="{Binding DownloadsText}"
                        Margin="0,-10,0,0">
                        <ListView
                            x:Name="LstDownloads"
                            Background="{StaticResource MegaAppBackgroundBrush}"
                            ItemsSource="{Binding MegaTransfers.Downloads}"
                            ItemTemplate="{StaticResource MegaTransferItemContent}"
                            RightTapped="OnRightTapped"
                            Holding="OnHolding">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <FlyoutBase.AttachedFlyout>
                                <MenuFlyout x:Name="DownloadsMenuFlyout">
                                    <MenuFlyout.Items>
                                        <MenuFlyoutItem
                                            Text="{Binding CancelText}"
                                            Command="{Binding CancelTransferCommand}"/>                                        
                                    </MenuFlyout.Items>
                                </MenuFlyout>
                            </FlyoutBase.AttachedFlyout>
                        </ListView>
                    </PivotItem>
                </Pivot>
            </Grid>
        </Grid>    

        <CommandBar 
            Grid.Row="1"
            Style="{StaticResource MegaCommandBarStyle}">
            <AppBarButton 
                x:Name="PauseResumeButton"
                Icon="Pause" 
                Label="{Binding PauseText}" 
                Click="OnPauseResumeClick"/>

            <CommandBar.SecondaryCommands>
                <AppBarButton
                    x:Name="CancelButton"
                    Icon="Cancel"
                    Click="OnCancelClick"/>
                <AppBarButton
                    x:Name="CleanUpButton"
                    Icon="Clear"
                    Label="{Binding CleanUpTransfersText}" 
                    Click="OnCleanUpTransfersClick"/>
            </CommandBar.SecondaryCommands>
        </CommandBar>
    </Grid>
</views:BaseTransferManagerPage>
